# 4.1 서버 사이드 렌더링이란?

## 4.1.1 싱글 페이지 애플리케이션의 세상

### 싱글 페이지 애플리케이션이란?

- **SPA** : 브라우저의 **자바스크립트에 의존**하여 페이지 내 모든 기능을 관리하는 애플리케이션
  - 최초에 HTML, CSS, 자바스크립트 등 필요한 자원을 한 번만 로드하고 이후에는 **페이지 전환 없이** 자바스크립트로 UI를 업데이트
  - **리렌더링 및 라우팅** 또한 브라우저에서 관리하여 사용자 경험이 더 빠르고 자연스러움
- **HTML 초기 로드** 시 `<body />` 내용이 비어 있음:
  - 브라우저에 전달된 HTML에는 `<body />` 내부에 콘텐츠가 없으며, **자바스크립트가 로드된 후**에야 UI가 렌더링됨
  - **페이지 전환** 시에도 자바스크립트가 필요한 데이터를 비동기적으로 요청해 응답을 받아 DOM을 업데이트하여 페이지를 전환함
    - 따라서 **전체 페이지 리로드 없이** UI를 부분적으로 갱신

### 전통적인 방식의 애플리케이션과 SPA의 작동 비교

- **전통적 방식**: 페이지 전환 시 서버에 새로운 HTML 페이지를 요청하고 **페이지 전체를 다시 로드**하여 렌더링하는 방식
  - 서버는 요청마다 HTML 페이지를 생성하고 전달하므로 초기 렌더링 속도가 빠르고 SEO에 유리하지만 페이지 전환 시 **응답 시간이 길어** 사용자 경험이 단절
- **SPA 방식**: 한 번 로드 후 자바스크립트를 통해 필요한 부분만 갱신하여 **페이지 전환을 빠르게 처리**함
  - 그러나 **초기 로딩 시간이 길고**, **SEO 최적화가 어려운 단점**이 있음

### 싱글 페이지 렌더링 방식의 유행과 JAM 스택의 등장

- SPA 방식의 유행으로 **JAM 스택**이 등장
  - JAM 스택
    - **JavaScript**, **API**, **Markup**의 약자
    - 서버가 아니라 **클라이언트에서 비동기적으로 데이터와 콘텐츠를 제공**하는 구조
    - 서버 부하를 줄이고 성능을 높이며 **사용자에게 더 빠르고 유연한 경험**을 제공

### 새로운 패러다임의 웹 서비스에 대한 요구

- 웹 애플리케이션의 **자바스크립트 리소스 크기와 개수 증가**
  - SPA 방식의 대중화로 인해 **자바스크립트 코드가 많아져 초기 로딩 시간과 리소스 관리가 어려워짐**
  - 성능 최적화와 사용자 경험 개선을 위해 **서버 사이드 렌더링**이나 **정적 사이트 생성(SSG)** 등의 대안이 제시됨

## 4.1.2 서버 사이드 렌더링이란?

- **서버 사이드 렌더링(SSR)** : 초기 HTML을 서버에서 렌더링하여 첫 화면을 빠르게 사용자에게 제공하는 방식
- 클라이언트가 서버로부터 미리 렌더링된 HTML을 전달받아 **초기 로드 시간**이 줄어들고, **SEO 및 소셜 공유 최적화**가 용이해짐

### 서버 사이드 렌더링의 장점

#### 최초 페이지 진입 속도가 비교적 빠름

- **첫 번째 콘텐츠 표시(First Contentful Paint)**가 빨라지므로, 초기 진입 시 유의미한 정보가 더 빨리 표시됨
- 서버에서 미리 생성된 HTML을 전달하므로, 클라이언트에서 JavaScript로 DOM을 생성하는 것보다 빠르게 화면이 제공

#### 검색 엔진 최적화 및 SNS 공유에 유리

- 검색 엔진이 페이지에 필요한 **메타 정보**를 쉽게 가져갈 수 있음
  - **검색 엔진 크롤링 과정**:
    1. 검색 엔진 봇이 페이지에 진입
    2. HTML 정보가 로드되어 크롤러가 페이지 정보를 수집 (JavaScript 코드는 실행되지 않음)
    3. HTML 내부의 오픈 그래프(Open Graph) 및 메타 태그를 바탕으로 검색 엔진에 최적화된 정보를 제공
- SSR에서는 서버가 렌더링을 처리하므로, 검색 엔진 최적화를 위한 **메타 데이터 및 초기 콘텐츠**를 더 쉽게 제공함

#### 누적 레이아웃 이동(Cumulative Layout Shift, CLS)이 적음

- **누적 레이아웃 이동**: 페이지가 로드되는 도중 콘텐츠가 뒤늦게 추가되거나 삭제되어 사용자 경험에 부정적인 영향을 주는 현상
- SSR은 모든 요청이 완료된 후 완성된 페이지를 제공하므로 클라이언트 사이드 렌더링보다 레이아웃 이동이 적음

#### 사용자의 디바이스 성능에 대한 의존도가 낮음

- 클라이언트 사이드 렌더링은 사용자 디바이스에서 JavaScript 리소스를 실행하므로 디바이스 성능에 의존적임
- SSR은 초기 렌더링을 서버가 처리하므로 **저사양 디바이스**에서도 초기 로딩 성능이 더 좋을 수 있음

#### 보안 측면에서 비교적 안전

- JAM 스택과 달리 SSR은 민감한 로직을 서버에서 처리하므로 모든 활동이 브라우저에 노출되지 않아 보안성이 향상됨

### 단점

#### 소스코드 작성 시 서버 환경을 고려해야 함

- 브라우저 전용 객체인 `window`에 직접 접근하는 코드가 SSR에서는 오류를 유발할 수 있으므로 **서버와 클라이언트 환경을 모두 고려**해야 함

#### 적절한 서버 인프라 필요

- SSR은 **서버에서 사용자의 요청을 받아 렌더링을 수행**하므로 빠르게 응답을 제공할 수 있는 서버 인프라가 필요함

#### 서비스 지연에 따른 문제

- SSR의 초기 렌더링은 서버에 의존하므로 요청 처리 시간이 길어지면 사용자 경험에 부정적 영향을 미칠 수 있음
- SPA와 달리 로딩 중 안내가 없는 경우 사용자 경험이 악화될 수 있음

## 4.1.3 SPA와 SSR을 모두 알아야 하는 이유

### 서버 사이드 렌더링의 한계

- SSR이 모든 상황에서 최적의 성능을 보장하는 것은 아님
- 클라이언트에서 발생하는 모든 무거운 작업을 서버로 옮기더라도, 서버 부하가 증가하여 성능 문제가 발생할 수 있음

### 싱글 페이지 애플리케이션(SPA)과 서버 사이드 렌더링 애플리케이션(SSR)

- SPA와 SSR을 비교할 때 유의미한 관점:
  1. **최적화된 SPA**는 최적화되지 않은 MPA보다 성능이 우수할 수 있음
  2. 반대로, **평균적인 SPA**는 평균적인 MPA보다 성능이 낮을 수 있음

### 현대의 서버 사이드 렌더링 (SSR)

- 초기에 완성된 HTML을 서버에서 제공하고, 이후에는 클라이언트에서 JavaScript를 바탕으로 **클라이언트 측 라우팅**을 통해 동작
  - 즉, 서버와 클라이언트가 **렌더링 작업을 분담**하여 초기 속도와 사용자 경험을 동시에 최적화함
- 이러한 구조를 이해하지 못하면 모든 페이지를 SSR로 처리하는 과거의 LAMP 스택과 같은 MPA를 만들 수 있으며 반대로 클라이언트에서만 동작하는 SPA가 될 위험이 있음

=> SSR과 SPA 모두 각각의 장단점이 있으므로, **프로젝트 특성과 사용자가 원하는 경험에 맞게 두 접근 방식을 혼합**하는 것이 중요
